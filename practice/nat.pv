type key.
free c: channel.
free s: bitstring [private].

fun ienc(nat, key): bitstring.
fun idec(bitstring, key):nat
reduc forall x:nat, y:key; idec(ienc(x+1, y),y) = x.

query attacker(s).

process
    new k:key; (
        out(c, ienc(2,k))
        | in(c, x:nat); in(c, y:bitstring); if x+3 > idec(y,k) then out(c,s)
    )